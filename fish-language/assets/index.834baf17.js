var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;import{j as c,r as l,m as o,R as u,a as d}from"./vendor.64689e20.js";const p=c.exports.jsx,m=c.exports.jsxs,h=c.exports.Fragment,b=({children:e})=>m("div",{className:"layout container bg-white",children:[p("div",{className:"row",children:p("h1",{className:"col text-center",children:"The Online ><> Interpreter"})}),p("div",{className:"row",children:m("small",{className:"col text-center",children:["Source code available on ",p("a",{href:"https://github.com/Suppen/fishlanguage.com",children:"GitHub"})]})}),p("div",{className:"row",children:e})]}),v=({execute:e})=>{const t=l.exports.useRef(null),r=(()=>{const e=l.exports.useRef(null);return l.exports.useEffect((()=>(e.current=window.localStorage,()=>{e.current=null})),[]),{get:e=>null,set:(t,r)=>!!e.current&&(e.current.setItem(t,r),!0)}})();return p(b,{children:m("div",{className:"fish-code-editor col",children:[p("textarea",{className:"form-control",ref:t,defaultValue:"",placeholder:"Write your ><> code here"}),p("div",{className:"btn-group",children:p("button",{type:"button",className:"btn btn-primary",onClick:()=>{var n;r.set("code",(null==(n=t.current)?void 0:n.value)||""),e()},children:"Submit"})})]})})},f=({grid:e,instructionPointer:t})=>p("table",{className:"fish-program-code-view text-center",children:p("tbody",{children:e.map(((e,r)=>p("tr",{children:e.map(((e,n)=>{let a=null;return Math.max(t.x,0)===n&&t.y===r&&(a="active"),p("td",{className:"fish-code-cell "+a,children:String.fromCharCode(e)},n)}))},r)))})});var x,N;(N=x||(x={}))[N.Text=0]="Text",N[N.Number=1]="Number";const g=({className:e,label:t,initialViewMode:r,buffer:n})=>{const[a,s]=l.exports.useState(r),i=a===x.Text?n.map((e=>String.fromCharCode(e))):n;return m("div",{className:e,children:[m("label",{children:[p("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:()=>{s((e=>e===x.Text?x.Number:x.Text))},children:a===x.Text?"A":"#"}),p("span",{children:t})]}),p("div",{className:"buffer-view",children:0===i.length?p("p",{children:"Empty"}):p("table",{children:p("tbody",{children:p("tr",{children:i.map(((e,t)=>p("td",{children:e},t)))})})})})]})},y=({className:e,output:t})=>{const[r,n]=l.exports.useState(x.Text),a=r===x.Text?t:(e=>{const t=e.split("").map((e=>e.charCodeAt(0))).map((e=>e.toString(16))).map((e=>e.padStart(2,"0"))).join(""),r=[];for(let a=0;a<t.length;a+=2)r.push(t.slice(a,a+2));const n=[];for(let a=0;a<r.length;a+=16)n.push(r.slice(a,a+16));return n.map((e=>e.join(" "))).join("\n")})(t);return m("div",{className:`${e} output-view`,children:[m("label",{children:[p("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:()=>{n((e=>e===x.Text?x.Number:x.Text))},children:r===x.Text?"A":"x"}),p("span",{children:"Output"})]}),p("pre",{className:"bg-light",children:a})]})},S=({inputBuffer:e,stackSnapshot:t,output:r,advances:n})=>m("div",{className:"row",children:[p(g,{buffer:e.map((e=>e.charCodeAt(0))),initialViewMode:x.Text,label:"Input queue",className:"col-6"}),p(g,{buffer:t,initialViewMode:x.Number,label:"Stack",className:"col-6"}),p(y,{output:r,className:"col-6"}),m("div",{className:"col-6",children:[p("label",{children:"Steps taken"}),p("p",{children:n})]})]}),T=(e,t)=>t===x.Text?e.split("").map((e=>e.charCodeAt(0))):e.split(",").map((e=>e.trim())).map((e=>Number(e))),k=({setInitialStack:e,changeIntervalTime:t,giveInput:r,intervalTime:n,hasStarted:a,isPaused:s,hasTerminated:i,run:c,pause:o,resume:u,step:d,reset:b,edit:v,inputBuffer:f,stackSnapshot:N,output:g,error:y,advances:k})=>{const C=l.exports.useRef(null),w=l.exports.useRef(null),P=l.exports.useRef(null),I=e=>{if(!P.current)return;const t=P.current.value||"";T(t,e).map((e=>String.fromCharCode(e))).forEach((e=>r(e))),P.current.value=""},j=t=>{var r;const n=(null==(r=C.current)?void 0:r.value)||"",a=T(n,t);e(a),C.current.value=""},E=Math.sqrt(1e3*n);return m("div",{className:"fish-program-executor-controls",children:[p("div",{children:m("div",{className:"btn-group",children:[i?p("button",{type:"button",className:"btn btn-danger",onClick:b,children:"Reset"}):a?s?m(h,{children:[p("button",{type:"button",className:"btn btn-success",onClick:u,children:"Resume"},"resume"),p("button",{type:"button",className:"btn btn-primary",onClick:d,children:"Step"},"step"),p("button",{type:"button",className:"btn btn-danger",onClick:b,children:"Reset"},"reset")]}):p("button",{type:"button",className:"btn btn-primary",onClick:o,children:"Pause"}):p("button",{type:"button",className:"btn btn-success",onClick:c,children:"Start"}),p("button",{type:"button",className:"btn btn-warning",onClick:v,children:"Return to editor"})]})}),!!y&&p("div",{className:"error bg-danger col-12",children:p("p",{className:"text-white text-center",children:y.message})}),!a&&m("div",{children:[p("label",{children:"Set initial stack"}),m("div",{children:[p("input",{type:"text",ref:C,className:"form-control"}),m("div",{className:"btn-group",children:[p("button",{type:"button",className:"btn btn-primary",onClick:()=>j(x.Text),children:"Interpret as text"}),p("button",{type:"button",className:"btn btn-primary",onClick:()=>j(x.Number),children:"Interpret as array"})]})]})]}),m("div",{className:"execution-speed",children:[p("label",{children:"Execution speed"}),p("div",{children:p("input",{ref:w,className:"form-control",type:"range",min:"0",max:"1000",step:"0.25",value:E,onChange:()=>{var e;const r=.001*Number(null==(e=w.current)?void 0:e.value)**2;t(r)}})})]}),p(S,{output:g,inputBuffer:f,stackSnapshot:N,advances:k}),m("div",{children:[p("label",{children:"Write to input stream"}),m("div",{children:[p("textarea",{ref:P,className:"form-control"}),m("div",{className:"btn-group",children:[p("button",{type:"button",className:"btn btn-primary",onClick:()=>I(x.Text),children:"Interpret as text"}),p("button",{type:"button",className:"btn btn-primary",onClick:()=>I(x.Number),children:"Interpret as array"})]})]})]})]})},C=({source:e,initialStack:c,edit:u})=>{const[d,h]=l.exports.useState({grid:[],instructionPointer:{x:0,y:0},inputBuffer:[],stackSnapshot:[],output:"",error:null,intervalTime:0,hasStarted:!1,isPaused:!1,hasTerminated:!1,advances:0}),v=e=>{h({grid:e.grid,instructionPointer:e.instructionPointer,inputBuffer:e.inputBuffer,stackSnapshot:e.stackSnapshot,output:e.output,error:e.error,intervalTime:e.intervalTime,hasStarted:e.hasStarted,isPaused:e.isPaused,hasTerminated:e.hasTerminated,advances:e.advances})},[x,N]=l.exports.useState([]),g=l.exports.useRef(),y=t=>{N(t);let r=[];g.current&&!g.current.hasStarted&&(r=g.current.inputBuffer),g.current=new o(e,t),r.forEach((e=>g.current.giveInput(e))),v(g.current),g.current.onUpdate(v)};return l.exports.useEffect((()=>{y(c||[])}),[]),g.current?p(b,{children:m("div",{className:"fish-code-executor-view col",children:[p(f,{grid:d.grid,instructionPointer:d.instructionPointer}),p(k,{intervalTime:d.intervalTime,changeIntervalTime:e=>{g.current.intervalTime=e,h((c=>{return l=((e,t)=>{for(var r in t||(t={}))a.call(t,r)&&i(e,r,t[r]);if(n)for(var r of n(t))s.call(t,r)&&i(e,r,t[r]);return e})({},c),t(l,r({intervalTime:e}));var l}))},hasStarted:d.hasStarted,isPaused:d.isPaused,hasTerminated:d.hasTerminated,run:g.current.run,pause:g.current.pause,resume:g.current.resume,step:g.current.step,giveInput:g.current.giveInput,reset:y.bind(void 0,x),edit:u,setInitialStack:y,inputBuffer:d.inputBuffer,stackSnapshot:d.stackSnapshot,output:d.output,advances:d.advances,error:d.error})]})}):null};var w,P;(P=w||(w={}))[P.Editing=0]="Editing",P[P.Executing=1]="Executing";const I=()=>{const[e,t]=l.exports.useState(0),r=e=>t(e);return 0===e?p(v,{execute:()=>r(1)}):p(C,{source:localStorage.code,edit:()=>r(0)})};u.render(p(d.StrictMode,{children:p(I,{})}),document.getElementById("root"));
